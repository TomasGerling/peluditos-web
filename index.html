<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="description" content="Peluditos Petshop en Necochea. Catálogo actualizado con los mejores precios en alimento balanceado y accesorios para tu mascota.">
    <meta name="keywords" content="petshop necochea, alimento balanceado, mascotas, perros, gatos, accesorios mascotas">
    <meta name="theme-color" content="#FF8C42">
    
    <!-- Preconnects para mejor performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">
    <link rel="dns-prefetch" href="https://unpkg.com">

    <title>Peluditos Petshop - Catálogo Online Necochea</title>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-R43T32J1Z1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-R43T32J1Z1');
    </script>

    <!-- Fonts con display=swap para mejor performance -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;600&family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- FontAwesome cargado de forma optimizada -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"></noscript>
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<header role="banner">
    <a href="#" class="logo" onclick="location.reload()" aria-label="Ir a inicio - Peluditos Petshop">
        <i class="fa-solid fa-paw" aria-hidden="true"></i> 
        <span>Peluditos</span>
    </a>
    
    <div class="header-actions">
        <div id="shop-status" class="status-badge closed" role="status" aria-live="polite">
            <span class="status-circle" aria-hidden="true"></span> 
            <span id="status-text">Cerrado</span>
        </div>

        <button id="user-btn-display" class="user-btn" onclick="openLoginOrProfile()" aria-label="Ingresar o ver perfil de usuario">
            <i class="fa-regular fa-user" aria-hidden="true"></i> 
            <span>Ingresar</span>
        </button>

        <button class="theme-toggle" onclick="toggleTheme()" id="themeBtn" aria-label="Cambiar entre modo oscuro y claro">
            <i class="fa-solid fa-moon" aria-hidden="true"></i>
        </button>
    </div>
</header>

<main role="main">
    <!-- Hero Section -->
    <section class="hero" aria-labelledby="hero-title">
        <h1 id="hero-title">Lo mejor para tu mascota</h1>
        <p>Alimento balanceado y accesorios en Necochea</p>
        <div class="promo-pill" role="note">
            <i class="fa-solid fa-gift" aria-hidden="true"></i> 
            <span>Promo: 10kg acumulables = 1kg de regalo</span>
        </div>
    </section>

    <!-- Search and Filters -->
    <div class="controls-wrapper">
        <div class="search-container">
            <div class="search-row">
                <div class="search-box">
                    <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>
                    <input 
                        type="search" 
                        id="searchInput" 
                        placeholder="Buscar marca, producto..." 
                        onkeyup="applyFilters()" 
                        aria-label="Buscar producto por nombre o marca"
                        autocomplete="off">
                </div>
                <select 
                    id="priceSort" 
                    class="sort-select" 
                    onchange="applyFilters()" 
                    aria-label="Ordenar productos por precio">
                    <option value="default">Relevancia</option>
                    <option value="asc">Precio: Menor a Mayor</option>
                    <option value="desc">Precio: Mayor a Menor</option>
                </select>
            </div>
            
            <nav class="filter-scroll" role="navigation" aria-label="Filtros de categoría">
                <button 
                    class="filter-btn active" 
                    onclick="setCategory('all', this)" 
                    aria-label="Ver todos los productos"
                    data-category="all">
                    <span>Todos</span>
                </button>
                <button 
                    class="filter-btn" 
                    onclick="setCategory('perro', this)" 
                    aria-label="Filtrar productos para perros"
                    data-category="perro">
                    <i class="fa-solid fa-dog" aria-hidden="true"></i> 
                    <span>Perros</span>
                </button>
                <button 
                    class="filter-btn" 
                    onclick="setCategory('gato', this)" 
                    aria-label="Filtrar productos para gatos"
                    data-category="gato">
                    <i class="fa-solid fa-cat" aria-hidden="true"></i> 
                    <span>Gatos</span>
                </button>
                <button 
                    class="filter-btn" 
                    onclick="setCategory('otros', this)" 
                    aria-label="Filtrar otros productos"
                    data-category="otros">
                    <span>Otros</span>
                </button>
            </nav>
        </div>
    </div>

    <!-- Loading Skeleton -->
    <div id="loader" class="grid-container" aria-hidden="true">
        <div class="skeleton" role="presentation"></div>
        <div class="skeleton" role="presentation"></div>
        <div class="skeleton" role="presentation"></div>
        <div class="skeleton" role="presentation"></div>
    </div>

    <!-- Product Grid -->
    <div class="grid-container" id="product-grid" style="display:none;" role="region" aria-live="polite" aria-label="Lista de productos"></div>
</main>

<!-- Floating Action Buttons -->
<a 
    href="#" 
    id="supportBtn" 
    class="support-float" 
    aria-label="Contactar por WhatsApp" 
    rel="noopener noreferrer" 
    target="_blank"
    title="Contactar por WhatsApp">
    <i class="fa-brands fa-whatsapp" aria-hidden="true"></i>
</a>

<button 
    class="cart-float" 
    onclick="toggleCart()" 
    aria-label="Ver carrito de compras"
    title="Ver carrito">
    <i class="fa-solid fa-basket-shopping" aria-hidden="true"></i>
    <div class="cart-badge" id="cart-count" aria-live="polite">0</div>
</button>

<!-- Cart Overlay -->
<div 
    class="cart-overlay" 
    id="cart-overlay" 
    onclick="closeAllModals()"
    role="presentation"
    aria-hidden="true"></div>

<!-- Cart Modal -->
<aside 
    class="cart-modal" 
    id="cart-modal"
    role="dialog"
    aria-labelledby="cart-title"
    aria-modal="true">
    <div class="cart-header">
        <h2 id="cart-title" style="margin:0">Mi Pedido</h2>
        <button 
            onclick="closeAllModals()" 
            class="close-btn" 
            aria-label="Cerrar carrito"
            title="Cerrar">×</button>
    </div>
    <div class="cart-items" id="cart-items" role="list"></div>
    <div class="cart-footer">
        <div class="cart-total-row">
            <span>Total:</span>
            <span id="cart-total" aria-live="polite">$0</span>
        </div>
        <button 
            class="btn-whatsapp" 
            onclick="checkout()" 
            aria-label="Iniciar proceso de pedido">
            Iniciar Pedido
        </button>
    </div>
</aside>

<!-- Checkout Modal -->
<aside 
    class="cart-modal" 
    id="checkout-modal" 
    style="z-index: 1002;"
    role="dialog"
    aria-labelledby="checkout-title"
    aria-modal="true">
    <div class="cart-header">
        <h2 id="checkout-title" style="margin:0">
            <i class="fa-solid fa-clipboard-check" aria-hidden="true"></i> 
            Finalizar Pedido
        </h2>
        <button 
            onclick="closeCheckout()" 
            class="close-btn" 
            aria-label="Cerrar checkout"
            title="Cerrar">×</button>
    </div>
    <form class="cart-items" style="padding: 20px;" onsubmit="event.preventDefault(); sendOrder();">
        <div class="form-group">
            <label class="form-label" for="cx-name">
                <i class="fa-regular fa-user" aria-hidden="true"></i> 
                Información del Cliente
            </label>
            <div class="row">
                <input 
                    type="text" 
                    id="cx-name" 
                    class="form-input" 
                    placeholder="Tu Nombre *" 
                    required 
                    aria-label="Tu Nombre"
                    autocomplete="name">
                <input 
                    type="tel" 
                    id="cx-phone" 
                    class="form-input" 
                    placeholder="Teléfono *" 
                    required 
                    aria-label="Tu Teléfono"
                    autocomplete="tel">
            </div>
        </div>
        
        <fieldset class="form-group">
            <legend class="form-label">
                <i class="fa-solid fa-truck-fast" aria-hidden="true"></i> 
                Tipo de Entrega
            </legend>
            <div class="radio-group">
                <label class="radio-card">
                    <input 
                        type="radio" 
                        name="deliveryType" 
                        value="retiro" 
                        checked 
                        onchange="toggleAddress(false)">
                    <div class="radio-card-content">
                        <div class="radio-circle" aria-hidden="true"></div>
                        <div>
                            <div style="font-weight:700">Retiro en Local</div>
                            <div style="font-size:0.8rem; color:var(--text-light)">Sin costo</div>
                        </div>
                    </div>
                </label>
                <label class="radio-card">
                    <input 
                        type="radio" 
                        name="deliveryType" 
                        id="opt-delivery" 
                        value="delivery" 
                        onchange="toggleAddress(true)">
                    <div class="radio-card-content">
                        <div class="radio-circle" aria-hidden="true"></div>
                        <div>
                            <div style="font-weight:700">Delivery</div>
                            <div style="font-size:0.8rem; color:var(--text-light)" id="delivery-text">Envío a domicilio</div>
                        </div>
                    </div>
                </label>
            </div>
        </fieldset>
        
        <div id="address-section" class="hidden">
            <div class="form-group">
                <label class="form-label" for="cx-calle">Dirección de Entrega</label>
                <input 
                    type="text" 
                    id="cx-calle" 
                    class="form-input" 
                    placeholder="Calle y Altura *" 
                    style="margin-bottom:10px" 
                    aria-label="Calle y altura"
                    autocomplete="street-address">
                <div class="row">
                    <input 
                        type="text" 
                        id="cx-piso" 
                        class="form-input" 
                        placeholder="Piso/Depto" 
                        aria-label="Piso o departamento"
                        autocomplete="off">
                    <input 
                        type="text" 
                        id="cx-entre" 
                        class="form-input" 
                        placeholder="Entre calles" 
                        aria-label="Entre calles"
                        autocomplete="off">
                </div>
            </div>
        </div>
        
        <fieldset class="form-group">
            <legend class="form-label">
                <i class="fa-regular fa-credit-card" aria-hidden="true"></i> 
                Forma de Pago
            </legend>
            <div class="radio-group">
                <label class="radio-card">
                    <input 
                        type="radio" 
                        name="paymentType" 
                        value="efectivo" 
                        checked>
                    <div class="radio-card-content">
                        <div class="radio-circle" aria-hidden="true"></div>
                        <div>
                            <div style="font-weight:700">Efectivo</div>
                            <div style="font-size:0.8rem; color:var(--text-light)">Al recibir</div>
                        </div>
                    </div>
                </label>
                <label class="radio-card">
                    <input 
                        type="radio" 
                        name="paymentType" 
                        value="transferencia">
                    <div class="radio-card-content">
                        <div class="radio-circle" aria-hidden="true"></div>
                        <div>
                            <div style="font-weight:700">Transferencia</div>
                            <div style="font-size:0.8rem; color:var(--text-light)">Anticipado</div>
                        </div>
                    </div>
                </label>
            </div>
        </fieldset>
        
        <div class="form-group">
            <label class="form-label" for="cx-obs">
                <i class="fa-regular fa-comment" aria-hidden="true"></i> 
                Observaciones
            </label>
            <textarea 
                id="cx-obs" 
                class="form-input" 
                rows="2" 
                placeholder="Ej: Timbre no funciona..." 
                aria-label="Observaciones adicionales"></textarea>
        </div>
        
        <div class="cart-footer" style="padding:0; border:none;">
            <button 
                type="submit"
                class="btn-whatsapp" 
                aria-label="Confirmar y enviar pedido por WhatsApp">
                <i class="fa-brands fa-whatsapp" aria-hidden="true"></i> 
                Confirmar y Enviar
            </button>
        </div>
    </form>
</aside>

<!-- Login Modal -->
<aside 
    class="cart-modal" 
    id="login-modal" 
    style="z-index: 1003; height: auto; min-height: 50vh; bottom:0; top:auto; border-radius: 20px 20px 0 0;"
    role="dialog"
    aria-labelledby="login-title"
    aria-modal="true">
    <div class="cart-header">
        <h2 id="login-title" style="margin:0">Iniciar Sesión</h2>
        <button 
            onclick="closeAllModals()" 
            class="close-btn" 
            aria-label="Cerrar login"
            title="Cerrar">×</button>
    </div>
    <div class="cart-items login-content">
        <p style="color:var(--text-light); margin-bottom:20px;">
            Ingresa tu número de teléfono para acceder a tu historial.
        </p>
        <div id="step-phone">
            <label class="form-label" style="text-align:left" for="login-phone">
                Número de teléfono
            </label>
            <div class="phone-input-group">
                <div class="prefix-box">AR +54</div>
                <input 
                    type="tel" 
                    id="login-phone" 
                    class="phone-field" 
                    placeholder="Ej: 2262123456" 
                    onkeyup="checkEnter(event, 'checkPhone')" 
                    aria-label="Número de teléfono"
                    autocomplete="tel">
            </div>
            <button 
                class="login-btn-primary" 
                onclick="handleLoginCheck()" 
                aria-label="Continuar con login">
                Continuar
            </button>
        </div>
        <div id="step-name" class="hidden">
            <p style="color:var(--primary); font-weight:600;">¡Es tu primera vez aquí!</p>
            <label class="form-label" style="text-align:left" for="login-name">
                ¿Cómo te llamas?
            </label>
            <input 
                type="text" 
                id="login-name" 
                class="form-input" 
                placeholder="Tu Nombre" 
                style="margin-top:5px;" 
                onkeyup="checkEnter(event, 'register')" 
                aria-label="Tu nombre"
                autocomplete="name">
            <button 
                class="login-btn-primary" 
                onclick="handleRegister()" 
                aria-label="Crear cuenta nueva">
                Crear Cuenta
            </button>
        </div>
    </div>
</aside>

<!-- Profile Modal -->
<aside 
    class="cart-modal" 
    id="profile-modal" 
    style="z-index: 1003;"
    role="dialog"
    aria-labelledby="profile-title"
    aria-modal="true">
    <div class="cart-header">
        <h2 id="profile-title" style="margin:0">Mi Perfil</h2>
        <button 
            onclick="closeAllModals()" 
            class="close-btn" 
            aria-label="Cerrar perfil"
            title="Cerrar">×</button>
    </div>
    <div class="cart-items">
        <div class="profile-info-card">
            <div 
                class="profile-avatar" 
                id="profile-initial" 
                aria-hidden="true">U</div>
            <div>
                <h3 id="profile-name" style="margin:0;">Usuario</h3>
                <span id="profile-phone" style="color:var(--text-light); font-size:0.9rem;">...</span>
            </div>
            <button 
                onclick="logout()" 
                class="logout-btn"
                aria-label="Cerrar sesión"
                title="Cerrar sesión">
                <i class="fa-solid fa-right-from-bracket" aria-hidden="true"></i>
            </button>
        </div>
        <h3 style="margin-bottom:15px;">Historial de Pedidos</h3>
        <div id="history-container" role="list"></div>
    </div>
</aside>

<footer role="contentinfo">
    <p>
        <strong>Peluditos Petshop</strong><br>
        Necochea, Buenos Aires
    </p>
</footer>

<!-- Scripts cargados de forma optimizada -->
<script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11" defer></script>
<script src="script.js" defer></script>

</body>
</html>